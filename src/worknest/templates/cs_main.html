<h2>ğŸ“‹ ìƒë‹´ ëª©ë¡</h2>

<!-- ğŸ” ê²€ìƒ‰ ë° í•„í„° í¼ -->
<form method="GET" style="margin-bottom: 20px;">
    <input type="text" name="search" placeholder="ìƒë‹´ì ë˜ëŠ” ê³ ê°ì‚¬" value="{{ search }}">
    <select name="status">
        <option value="all" {% if status_filter=='all' %}selected{% endif %}>ì „ì²´</option>
        <option value="ì§„í–‰ì¤‘" {% if status_filter=='ì§„í–‰ì¤‘' %}selected{% endif %}>ì§„í–‰ì¤‘</option>
        <option value="ì™„ë£Œ" {% if status_filter=='ì™„ë£Œ' %}selected{% endif %}>ì™„ë£Œ</option>
    </select>
    <button type="submit">ê²€ìƒ‰</button>
</form>

{% if message %}
<script>
    alert("{{ message }}");
</script>
{% endif %}

<!-- ğŸ“„ ìƒë‹´ ë¦¬ìŠ¤íŠ¸ í…Œì´ë¸” -->
<table border="1" cellpadding="8">
<thead>
    <tr>
        <th>ID</th>
        <th>ê³ ê°ì‚¬</th>
        <th>ìƒë‹´ì</th>
        <th>ì¹´í…Œê³ ë¦¬</th>
        <th>ìƒíƒœ</th>
        <th>ë“±ë¡ì¼</th>
        <th>ì—…ë°ì´íŠ¸</th> 
    </tr>
</thead>
<tbody>
    {% for contact in contacts %}
    <tr>
        <td><a href="{{ url_for('cs_detail', contact_id=contact._id) }}">{{ contact._id }}</a></td>
        <td>{{ contact.client_name }}</td>
        <td>{{ contact.writer }}</td>
        <td>{{ contact.category }}</td>
        <td>{{ contact.status }}</td>
        <td>{{ contact.created_at.strftime('%Y-%m-%d') }}</td>
        <td>
            <!-- âœï¸ ìˆ˜ì • ë²„íŠ¼ -->
            <a href="{{ url_for('cs_update', contact_id=contact._id) }}">
                <button type="button">ìˆ˜ì •</button>
            </a>

            <!-- âŒ ì‚­ì œ ë²„íŠ¼ (POST ìš”ì²­ + hidden input í™œìš©) -->
            <form action="{{ url_for('cs_update', contact_id=contact._id) }}" method="POST" style="display:inline;" onsubmit="return confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');">
                <input type="hidden" name="action" value="delete">
                <button type="submit">ì‚­ì œ</button>
            </form>
        </td>
    </tr>
    {% else %}
    <tr><td colspan="7">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</td></tr>
    {% endfor %}
</tbody>
</table>

<!-- ğŸ“Œ í˜ì´ì§• -->
<div style="margin-top: 20px;">
    {% if page > 1 %}
        <a href="?search={{ search }}&status={{ status_filter }}&page={{ page - 1 }}">ì´ì „</a>
    {% endif %}

    í˜ì´ì§€ {{ page }} / {{ (total_count // 10) + (1 if total_count % 10 else 0) }}

    {% if page * 10 < total_count %}
        <a href="?search={{ search }}&status={{ status_filter }}&page={{ page + 1 }}">ë‹¤ìŒ</a>
    {% endif %}
</div>
